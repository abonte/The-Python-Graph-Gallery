{"componentChunkName":"component---src-pages-jupyter-notebook-slug-js","path":"/web-animated-line-chart-with-text/","result":{"data":{"jupyterNotebook":{"html":"<div class=\"notebook-render\"><div class=\"sc-fqkvVR cbsNYc\"><div class=\"sc-eqUAAy jevAiY cell\" style=\"box-shadow:none\"><div class=\"sc-jXbUNg gqRgKk markdown\"><h2>About</h2>\n<p>This plot is an <strong>animation</strong> that displays the evolution of plastic production in the world between 1950 and 2050.</p>\n<p>The chart was made by <a href=\"https://www.barbierjoseph.com/\">Joseph B</a> with <a href=\"/matplotlib\">matplotlib</a>. Thanks to him for accepting sharing his work here!</p>\n<p>Let&#x27;s see what the final picture will look like:</p>\n<p><img src=\"https://raw.githubusercontent.com/holtzy/The-Python-Graph-Gallery/master/static/animations/web-animated-line-chart-with-text.gif\" alt=\"gif\"/></p></div></div><div class=\"sc-eqUAAy jevAiY cell\" style=\"box-shadow:none\"><div class=\"sc-jXbUNg gqRgKk markdown\"><h2>Libraries</h2>\n<p>First, you need to load a whole bunch of libraries:</p></div></div><div class=\"sc-eqUAAy jevAiY cell\" style=\"box-shadow:none\"><div class=\"sc-gsFSXq eSaGKB input-container\"><pre class=\"sc-iGgWBj gcBMNR input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code class=\"language-python\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># data manipulation</span><span>\n</span><span></span><span class=\"token\" style=\"color:#0000ff\">import</span><span> pandas </span><span class=\"token\" style=\"color:#0000ff\">as</span><span> pd\n</span><span></span><span class=\"token\" style=\"color:#0000ff\">import</span><span> numpy </span><span class=\"token\" style=\"color:#0000ff\">as</span><span> np\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># make the charts</span><span>\n</span><span></span><span class=\"token\" style=\"color:#0000ff\">import</span><span> matplotlib</span><span class=\"token\" style=\"color:#393A34\">.</span><span>pyplot </span><span class=\"token\" style=\"color:#0000ff\">as</span><span> plt\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># annotations</span><span>\n</span><span></span><span class=\"token\" style=\"color:#0000ff\">import</span><span> textwrap\n</span><span></span><span class=\"token\" style=\"color:#0000ff\">import</span><span> math\n</span><span></span><span class=\"token\" style=\"color:#0000ff\">import</span><span> re\n</span><span></span><span class=\"token\" style=\"color:#0000ff\">from</span><span> matplotlib</span><span class=\"token\" style=\"color:#393A34\">.</span><span>ticker </span><span class=\"token\" style=\"color:#0000ff\">import</span><span> FormatStrFormatter\n</span><span></span><span class=\"token\" style=\"color:#0000ff\">from</span><span> highlight_text </span><span class=\"token\" style=\"color:#0000ff\">import</span><span> fig_text</span><span class=\"token\" style=\"color:#393A34\">,</span><span> ax_text\n</span><span></span><span class=\"token\" style=\"color:#0000ff\">from</span><span> matplotlib </span><span class=\"token\" style=\"color:#0000ff\">import</span><span> font_manager\n</span><span></span><span class=\"token\" style=\"color:#0000ff\">from</span><span> matplotlib</span><span class=\"token\" style=\"color:#393A34\">.</span><span>font_manager </span><span class=\"token\" style=\"color:#0000ff\">import</span><span> FontProperties\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># animation</span><span>\n</span><span></span><span class=\"token\" style=\"color:#0000ff\">from</span><span> PIL </span><span class=\"token\" style=\"color:#0000ff\">import</span><span> Image</span><span class=\"token\" style=\"color:#393A34\">,</span><span> ImageSequence\n</span><span></span><span class=\"token\" style=\"color:#0000ff\">from</span><span> matplotlib</span><span class=\"token\" style=\"color:#393A34\">.</span><span>animation </span><span class=\"token\" style=\"color:#0000ff\">import</span><span> FuncAnimation</span></code></pre></div></div><div class=\"sc-eqUAAy jevAiY cell\" style=\"box-shadow:none\"><div class=\"sc-jXbUNg gqRgKk markdown\"><h2>Dataset</h2>\n<p>For this reproduction, we&#x27;re going to retrieve the data directly from the gallery&#x27;s Github repo. This means we just need to <strong>give the right url as an argument</strong> to pandas&#x27; <code>read_csv()</code> function to retrieve the data.</p>\n<p>Then, we apply a few simple modifications to the data in order to have <strong>1 row per year</strong>, with 2 columns: the number of outer space object for the US and for the Russia.</p></div></div><div class=\"sc-eqUAAy jevAiY cell\" style=\"box-shadow:none\"><div class=\"sc-gsFSXq eSaGKB input-container\"><pre class=\"sc-iGgWBj gcBMNR input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code class=\"language-python\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># Open the dataset from Github</span><span>\n</span><span>url </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">&quot;https://raw.githubusercontent.com/holtzy/the-python-graph-gallery/master/static/data/global-plastics-production-interpolated.csv&quot;</span><span>\n</span><span>url </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">&quot;../../../Small-Projects/plastic-pollution/global-plastics-production-interpolated.csv&quot;</span><span>\n</span><span>df </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pd</span><span class=\"token\" style=\"color:#393A34\">.</span><span>read_csv</span><span class=\"token\" style=\"color:#393A34\">(</span><span>url</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\">#df.reset_index(inplace=True)</span><span>\n</span><span>df</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;year&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span> </span><span class=\"token\" style=\"color:#393A34\">=</span><span> np</span><span class=\"token\" style=\"color:#393A34\">.</span><span>linspace</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">1950</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">2050</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">1001</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>index </span><span class=\"token\" style=\"color:#393A34\">=</span><span> df</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;year&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>drop</span><span class=\"token\" style=\"color:#393A34\">(</span><span>columns</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;year&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span> inplace</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">True</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>head</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-kAyceB eLJVsY nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><div><div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>plastic-production</th>\n    </tr>\n    <tr>\n      <th>year</th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>1950.0</th>\n      <td>2.000000e+06</td>\n    </tr>\n    <tr>\n      <th>1950.1</th>\n      <td>2.010854e+06</td>\n    </tr>\n    <tr>\n      <th>1950.2</th>\n      <td>2.019297e+06</td>\n    </tr>\n    <tr>\n      <th>1950.3</th>\n      <td>2.025327e+06</td>\n    </tr>\n    <tr>\n      <th>1950.4</th>\n      <td>2.028945e+06</td>\n    </tr>\n  </tbody>\n</table>\n</div></div></div></div></div><div class=\"sc-eqUAAy jevAiY cell\" style=\"box-shadow:none\"><div class=\"sc-jXbUNg gqRgKk markdown\"><p>Now we have a dataset that fits perfectly the needs for this animation!</p></div></div><div class=\"sc-eqUAAy jevAiY cell\" style=\"box-shadow:none\"><div class=\"sc-jXbUNg gqRgKk markdown\"><h2>Minimalist animation</h2>\n<p>To understand the basics of animation in matplotlib, refer to <a href=\"/340-scatterplot-animation\">this detailed guide</a> which provides a step-by-step tutorial on crafting a straightforward animation.</p>\n<p>In our <code>update()</code> function, each frame represents a different year, emphasizing the <strong>most recent year</strong> to create a sense of a <strong>continuous trajectory</strong>.</p>\n<p>Additionally, we modify the <strong>background, annotations, and line colors</strong>, and opt for a lower <code>dpi</code> to <strong>decrease resolution</strong>, enhancing the animation&#x27;s creation speed.</p></div></div><div class=\"sc-eqUAAy jevAiY cell\" style=\"box-shadow:none\"><div class=\"sc-gsFSXq eSaGKB input-container\"><pre class=\"sc-iGgWBj gcBMNR input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code class=\"language-python\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># parameters</span><span>\n</span><span>background_color </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;#0d1b2a&#x27;</span><span>\n</span><span>text_color </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;#fefae0&#x27;</span><span>\n</span><span>line_color </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;#d90429&#x27;</span><span>\n</span><span>dpi </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">50</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># Setting up the plot</span><span>\n</span><span>fig</span><span class=\"token\" style=\"color:#393A34\">,</span><span> ax </span><span class=\"token\" style=\"color:#393A34\">=</span><span> plt</span><span class=\"token\" style=\"color:#393A34\">.</span><span>subplots</span><span class=\"token\" style=\"color:#393A34\">(</span><span>figsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">10</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">6</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span> dpi</span><span class=\"token\" style=\"color:#393A34\">=</span><span>dpi</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>fig</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_facecolor</span><span class=\"token\" style=\"color:#393A34\">(</span><span>background_color</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_facecolor</span><span class=\"token\" style=\"color:#393A34\">(</span><span>background_color</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>tick_params</span><span class=\"token\" style=\"color:#393A34\">(</span><span>axis</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;y&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> colors</span><span class=\"token\" style=\"color:#393A34\">=</span><span>text_color</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>spines</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;left&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_color</span><span class=\"token\" style=\"color:#393A34\">(</span><span>text_color</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># Update function for the animation</span><span>\n</span><span></span><span class=\"token\" style=\"color:#0000ff\">def</span><span> </span><span class=\"token\" style=\"color:#393A34\">update</span><span class=\"token\" style=\"color:#393A34\">(</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span>\n<span>    </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># skip first frame</span><span>\n</span><span>    </span><span class=\"token\" style=\"color:#0000ff\">if</span><span> frame </span><span class=\"token\" style=\"color:#393A34\">==</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span><span>        </span><span class=\"token\" style=\"color:#0000ff\">return</span><span> </span><span class=\"token\" style=\"color:#36acaa\">None</span><span>\n</span>\n<span>    </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># initialize subset of data</span><span>\n</span><span>    subset_df </span><span class=\"token\" style=\"color:#393A34\">=</span><span> df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>iloc</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">:</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>    ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>clear</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>    ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>yaxis</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_major_formatter</span><span class=\"token\" style=\"color:#393A34\">(</span><span>FormatStrFormatter</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;%.0f&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>    </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># create the line chart</span><span>\n</span><span>    ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>plot</span><span class=\"token\" style=\"color:#393A34\">(</span><span>subset_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>index</span><span class=\"token\" style=\"color:#393A34\">,</span><span> subset_df</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;plastic-production&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span> color</span><span class=\"token\" style=\"color:#393A34\">=</span><span>line_color</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>    ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>scatter</span><span class=\"token\" style=\"color:#393A34\">(</span><span>subset_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>index</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">-</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span> subset_df</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;plastic-production&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span>values</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">-</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span> color</span><span class=\"token\" style=\"color:#393A34\">=</span><span>line_color</span><span class=\"token\" style=\"color:#393A34\">,</span><span> s</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">100</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># create and save animation</span><span>\n</span><span>path </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;../../static/animations/web-animated-line-chart-with-text-1.gif&#x27;</span><span>\n</span><span>ani </span><span class=\"token\" style=\"color:#393A34\">=</span><span> FuncAnimation</span><span class=\"token\" style=\"color:#393A34\">(</span><span>fig</span><span class=\"token\" style=\"color:#393A34\">,</span><span> update</span><span class=\"token\" style=\"color:#393A34\">,</span><span> frames</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span><span>df</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>ani</span><span class=\"token\" style=\"color:#393A34\">.</span><span>save</span><span class=\"token\" style=\"color:#393A34\">(</span><span>path</span><span class=\"token\" style=\"color:#393A34\">,</span><span> fps</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">5</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-eqUAAy jevAiY cell\" style=\"box-shadow:none\"><div class=\"sc-jXbUNg gqRgKk markdown\"><p><img src=\"https://raw.githubusercontent.com/holtzy/The-Python-Graph-Gallery/master/static/animations/web-animated-line-chart-with-text-1.gif\" alt=\"gif\"/></p></div></div><div class=\"sc-eqUAAy jevAiY cell\" style=\"box-shadow:none\"><div class=\"sc-jXbUNg gqRgKk markdown\"><h2>Custom axes and add dates</h2>\n<p>In this phase, we tailor the <strong>chart&#x27;s appearance</strong> by:</p>\n<ul>\n<li><strong>eliminating the right, top, and bottom axes entirely</strong></li>\n<li><strong>modifying the y-scale to enhance visibility</strong></li>\n</ul>\n<p>Additionally, we incorporate <strong>reference dates</strong> into the backdrop using the <a href=\"/advanced-custom-annotations-matplotlib\"><strong>highlight_text package</strong></a>. Notably, the year <code>1950</code> remains a <strong>fixed point</strong>, while we allow the <strong>current date</strong> to adjust dynamically.</p></div></div><div class=\"sc-eqUAAy jevAiY cell\" style=\"box-shadow:none\"><div class=\"sc-gsFSXq eSaGKB input-container\"><pre class=\"sc-iGgWBj gcBMNR input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code class=\"language-python\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># parameters</span><span>\n</span><span>background_color </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;#0d1b2a&#x27;</span><span>\n</span><span>text_color </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;#fefae0&#x27;</span><span>\n</span><span>line_color </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;#d90429&#x27;</span><span>\n</span><span>dpi </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">50</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># Setting up the plot</span><span>\n</span><span>fig</span><span class=\"token\" style=\"color:#393A34\">,</span><span> ax </span><span class=\"token\" style=\"color:#393A34\">=</span><span> plt</span><span class=\"token\" style=\"color:#393A34\">.</span><span>subplots</span><span class=\"token\" style=\"color:#393A34\">(</span><span>figsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">10</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">6</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span> dpi</span><span class=\"token\" style=\"color:#393A34\">=</span><span>dpi</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>fig</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_facecolor</span><span class=\"token\" style=\"color:#393A34\">(</span><span>background_color</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_facecolor</span><span class=\"token\" style=\"color:#393A34\">(</span><span>background_color</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>tick_params</span><span class=\"token\" style=\"color:#393A34\">(</span><span>axis</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;y&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> colors</span><span class=\"token\" style=\"color:#393A34\">=</span><span>text_color</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>spines</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;left&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_color</span><span class=\"token\" style=\"color:#393A34\">(</span><span>text_color</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># font</span><span>\n</span><span>personal_path </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;/Users/josephbarbier/Library/Fonts/&#x27;</span><span>\n</span><span>font_path </span><span class=\"token\" style=\"color:#393A34\">=</span><span> personal_path </span><span class=\"token\" style=\"color:#393A34\">+</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;FiraSans-Light.ttf&#x27;</span><span>\n</span><span>font </span><span class=\"token\" style=\"color:#393A34\">=</span><span> FontProperties</span><span class=\"token\" style=\"color:#393A34\">(</span><span>fname</span><span class=\"token\" style=\"color:#393A34\">=</span><span>font_path</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>bold_font </span><span class=\"token\" style=\"color:#393A34\">=</span><span> FontProperties</span><span class=\"token\" style=\"color:#393A34\">(</span><span>fname</span><span class=\"token\" style=\"color:#393A34\">=</span><span>personal_path </span><span class=\"token\" style=\"color:#393A34\">+</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;FiraSans-Medium.ttf&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># Update function for the animation</span><span>\n</span><span></span><span class=\"token\" style=\"color:#0000ff\">def</span><span> </span><span class=\"token\" style=\"color:#393A34\">update</span><span class=\"token\" style=\"color:#393A34\">(</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span>\n<span>    </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># skip first frame</span><span>\n</span><span>    </span><span class=\"token\" style=\"color:#0000ff\">if</span><span> frame </span><span class=\"token\" style=\"color:#393A34\">==</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span><span>        </span><span class=\"token\" style=\"color:#0000ff\">return</span><span> </span><span class=\"token\" style=\"color:#36acaa\">None</span><span>\n</span>\n<span>    </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># initialize subset of data</span><span>\n</span><span>    subset_df </span><span class=\"token\" style=\"color:#393A34\">=</span><span> df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>iloc</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">:</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>    ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>clear</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>    ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>yaxis</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_major_formatter</span><span class=\"token\" style=\"color:#393A34\">(</span><span>FormatStrFormatter</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;%.0f&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>    </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># create the line chart</span><span>\n</span><span>    ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>plot</span><span class=\"token\" style=\"color:#393A34\">(</span><span>subset_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>index</span><span class=\"token\" style=\"color:#393A34\">,</span><span> subset_df</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;plastic-production&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span> color</span><span class=\"token\" style=\"color:#393A34\">=</span><span>line_color</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>    ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>scatter</span><span class=\"token\" style=\"color:#393A34\">(</span><span>subset_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>index</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">-</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span> subset_df</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;plastic-production&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span>values</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">-</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span> color</span><span class=\"token\" style=\"color:#393A34\">=</span><span>line_color</span><span class=\"token\" style=\"color:#393A34\">,</span><span> s</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">100</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>    </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># date in the background</span><span>\n</span><span>    year </span><span class=\"token\" style=\"color:#393A34\">=</span><span> df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>index</span><span class=\"token\" style=\"color:#393A34\">[</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>    fig_text</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>        </span><span class=\"token\" style=\"color:#36acaa\">0.14</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0.3</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        </span><span class=\"token\" style=\"color:#A31515\">&#x27;1950 - &#x27;</span><span> </span><span class=\"token\" style=\"color:#393A34\">+</span><span> </span><span class=\"token builtin\">str</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token builtin\">round</span><span class=\"token\" style=\"color:#393A34\">(</span><span>year</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        ha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;left&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> va</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;top&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        fontsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">30</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        font</span><span class=\"token\" style=\"color:#393A34\">=</span><span>bold_font</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        color</span><span class=\"token\" style=\"color:#393A34\">=</span><span>text_color</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        fontweight</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        alpha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">0.3</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        fig</span><span class=\"token\" style=\"color:#393A34\">=</span><span>fig\n</span><span>    </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>    </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># custom axes</span><span>\n</span><span>    y_min </span><span class=\"token\" style=\"color:#393A34\">=</span><span> df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>iloc</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">:</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">+</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span>axis</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">min</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>    y_max </span><span class=\"token\" style=\"color:#393A34\">=</span><span> df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>iloc</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">:</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">+</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span>axis</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">max</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>    ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_ylim</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">,</span><span> y_max</span><span class=\"token\" style=\"color:#393A34\">*</span><span class=\"token\" style=\"color:#36acaa\">1.1</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>    ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>spines</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;top&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;right&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;bottom&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_visible</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">False</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>    ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_xticks</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># create and save animation</span><span>\n</span><span>path </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;../../static/animations/web-animated-line-chart-with-text-2.gif&#x27;</span><span>\n</span><span>ani </span><span class=\"token\" style=\"color:#393A34\">=</span><span> FuncAnimation</span><span class=\"token\" style=\"color:#393A34\">(</span><span>fig</span><span class=\"token\" style=\"color:#393A34\">,</span><span> update</span><span class=\"token\" style=\"color:#393A34\">,</span><span> frames</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span><span>df</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>ani</span><span class=\"token\" style=\"color:#393A34\">.</span><span>save</span><span class=\"token\" style=\"color:#393A34\">(</span><span>path</span><span class=\"token\" style=\"color:#393A34\">,</span><span> fps</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">5</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-eqUAAy jevAiY cell\" style=\"box-shadow:none\"><div class=\"sc-jXbUNg gqRgKk markdown\"><p><img src=\"https://raw.githubusercontent.com/holtzy/The-Python-Graph-Gallery/master/static/animations/web-animated-line-chart-with-text-2.gif\" alt=\"gif\"/></p></div></div><div class=\"sc-eqUAAy jevAiY cell\" style=\"box-shadow:none\"><div class=\"sc-jXbUNg gqRgKk markdown\"><h2>Add title and source</h2>\n<p>A visualization remains incomplete without a title. To enhance it, consider adding two key annotations:</p>\n<ul>\n<li><strong>Title</strong>: Elevates the understanding and significance of the visualization.</li>\n<li><strong>Credit/Source</strong>: Establishes credibility and acknowledges the original data or inspiration.</li>\n</ul>\n<p>Both elements can be effectively incorporated using the <a href=\"/advanced-custom-annotations-matplotlib\"><strong>highlight_text package</strong></a>.</p></div></div><div class=\"sc-eqUAAy jevAiY cell\" style=\"box-shadow:none\"><div class=\"sc-gsFSXq eSaGKB input-container\"><pre class=\"sc-iGgWBj gcBMNR input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code class=\"language-python\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># parameters</span><span>\n</span><span>background_color </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;#0d1b2a&#x27;</span><span>\n</span><span>text_color </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;#fefae0&#x27;</span><span>\n</span><span>line_color </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;#d90429&#x27;</span><span>\n</span><span>dpi </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">50</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># Setting up the plot</span><span>\n</span><span>fig</span><span class=\"token\" style=\"color:#393A34\">,</span><span> ax </span><span class=\"token\" style=\"color:#393A34\">=</span><span> plt</span><span class=\"token\" style=\"color:#393A34\">.</span><span>subplots</span><span class=\"token\" style=\"color:#393A34\">(</span><span>figsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">10</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">6</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span> dpi</span><span class=\"token\" style=\"color:#393A34\">=</span><span>dpi</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>fig</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_facecolor</span><span class=\"token\" style=\"color:#393A34\">(</span><span>background_color</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_facecolor</span><span class=\"token\" style=\"color:#393A34\">(</span><span>background_color</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>tick_params</span><span class=\"token\" style=\"color:#393A34\">(</span><span>axis</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;y&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> colors</span><span class=\"token\" style=\"color:#393A34\">=</span><span>text_color</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>spines</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;left&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_color</span><span class=\"token\" style=\"color:#393A34\">(</span><span>text_color</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># font</span><span>\n</span><span>personal_path </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;/Users/josephbarbier/Library/Fonts/&#x27;</span><span>\n</span><span>font_path </span><span class=\"token\" style=\"color:#393A34\">=</span><span> personal_path </span><span class=\"token\" style=\"color:#393A34\">+</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;FiraSans-Light.ttf&#x27;</span><span>\n</span><span>font </span><span class=\"token\" style=\"color:#393A34\">=</span><span> FontProperties</span><span class=\"token\" style=\"color:#393A34\">(</span><span>fname</span><span class=\"token\" style=\"color:#393A34\">=</span><span>font_path</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>bold_font </span><span class=\"token\" style=\"color:#393A34\">=</span><span> FontProperties</span><span class=\"token\" style=\"color:#393A34\">(</span><span>fname</span><span class=\"token\" style=\"color:#393A34\">=</span><span>personal_path </span><span class=\"token\" style=\"color:#393A34\">+</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;FiraSans-Medium.ttf&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># Update function for the animation</span><span>\n</span><span></span><span class=\"token\" style=\"color:#0000ff\">def</span><span> </span><span class=\"token\" style=\"color:#393A34\">update</span><span class=\"token\" style=\"color:#393A34\">(</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span>\n<span>    </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># skip first frame</span><span>\n</span><span>    </span><span class=\"token\" style=\"color:#0000ff\">if</span><span> frame </span><span class=\"token\" style=\"color:#393A34\">==</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span><span>        </span><span class=\"token\" style=\"color:#0000ff\">return</span><span> </span><span class=\"token\" style=\"color:#36acaa\">None</span><span>\n</span>\n<span>    </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># initialize subset of data</span><span>\n</span><span>    subset_df </span><span class=\"token\" style=\"color:#393A34\">=</span><span> df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>iloc</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">:</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>    ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>clear</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>    ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>yaxis</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_major_formatter</span><span class=\"token\" style=\"color:#393A34\">(</span><span>FormatStrFormatter</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;%.0f&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>    </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># create the line chart</span><span>\n</span><span>    ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>plot</span><span class=\"token\" style=\"color:#393A34\">(</span><span>subset_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>index</span><span class=\"token\" style=\"color:#393A34\">,</span><span> subset_df</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;plastic-production&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span> color</span><span class=\"token\" style=\"color:#393A34\">=</span><span>line_color</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>    ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>scatter</span><span class=\"token\" style=\"color:#393A34\">(</span><span>subset_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>index</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">-</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span> subset_df</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;plastic-production&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span>values</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">-</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span> color</span><span class=\"token\" style=\"color:#393A34\">=</span><span>line_color</span><span class=\"token\" style=\"color:#393A34\">,</span><span> s</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">100</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>    </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># date in the background</span><span>\n</span><span>    year </span><span class=\"token\" style=\"color:#393A34\">=</span><span> df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>index</span><span class=\"token\" style=\"color:#393A34\">[</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>    fig_text</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>        </span><span class=\"token\" style=\"color:#36acaa\">0.14</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0.3</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        </span><span class=\"token\" style=\"color:#A31515\">&#x27;1950 - &#x27;</span><span> </span><span class=\"token\" style=\"color:#393A34\">+</span><span> </span><span class=\"token builtin\">str</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token builtin\">round</span><span class=\"token\" style=\"color:#393A34\">(</span><span>year</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        ha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;left&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> va</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;top&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        fontsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">30</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        font</span><span class=\"token\" style=\"color:#393A34\">=</span><span>bold_font</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        color</span><span class=\"token\" style=\"color:#393A34\">=</span><span>text_color</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        fontweight</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        alpha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">0.3</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        fig</span><span class=\"token\" style=\"color:#393A34\">=</span><span>fig\n</span><span>    </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>    </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># custom axes</span><span>\n</span><span>    y_min </span><span class=\"token\" style=\"color:#393A34\">=</span><span> df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>iloc</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">:</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">+</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span>axis</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">min</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>    y_max </span><span class=\"token\" style=\"color:#393A34\">=</span><span> df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>iloc</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">:</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">+</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span>axis</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">max</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>    ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_ylim</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">,</span><span> y_max</span><span class=\"token\" style=\"color:#393A34\">*</span><span class=\"token\" style=\"color:#36acaa\">1.1</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>    ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>spines</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;top&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;right&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;bottom&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_visible</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">False</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>    ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_xticks</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>    </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># title</span><span>\n</span><span>    text </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">&quot;&quot;&quot;&lt;Global plastics production has grown dramatically and is set to continue to do so&gt;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">    &lt;Evolution and prediction of annual plastic production&gt;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">    &lt;Data after 2020 are predicted values based on a polynomial regression&gt;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">    &quot;&quot;&quot;</span><span>\n</span><span>    fig_text</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>        </span><span class=\"token\" style=\"color:#36acaa\">0.13</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0.92</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        text</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        ha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;left&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> va</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;top&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        font</span><span class=\"token\" style=\"color:#393A34\">=</span><span>font</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        highlight_textprops</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">[</span><span>\n</span><span>            </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;color&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span>text_color</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;fontsize&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#36acaa\">14</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;font&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span>bold_font</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>            </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;color&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span>text_color</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;fontsize&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#36acaa\">10</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>            </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;color&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span>text_color</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;fontsize&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#36acaa\">10</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        </span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        fig</span><span class=\"token\" style=\"color:#393A34\">=</span><span>fig\n</span><span>    </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>    </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># credit annotation</span><span>\n</span><span>    text </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">&quot;&quot;&quot;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">    Developed by &lt;@joseph_barbier&gt;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">    &quot;&quot;&quot;</span><span>\n</span><span>    fig_text</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>        </span><span class=\"token\" style=\"color:#36acaa\">0.9</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        text</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        ha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;right&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> va</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;bottom&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        fontsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">7</span><span class=\"token\" style=\"color:#393A34\">,</span><span> font</span><span class=\"token\" style=\"color:#393A34\">=</span><span>font</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        color</span><span class=\"token\" style=\"color:#393A34\">=</span><span>text_color</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        highlight_textprops</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">[</span><span>\n</span><span>            </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;font&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span>bold_font</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        </span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        fig</span><span class=\"token\" style=\"color:#393A34\">=</span><span>fig\n</span><span>    </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># create and save animation</span><span>\n</span><span>path </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;../../static/animations/web-animated-line-chart-with-text-3.gif&#x27;</span><span>\n</span><span>ani </span><span class=\"token\" style=\"color:#393A34\">=</span><span> FuncAnimation</span><span class=\"token\" style=\"color:#393A34\">(</span><span>fig</span><span class=\"token\" style=\"color:#393A34\">,</span><span> update</span><span class=\"token\" style=\"color:#393A34\">,</span><span> frames</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span><span>df</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>ani</span><span class=\"token\" style=\"color:#393A34\">.</span><span>save</span><span class=\"token\" style=\"color:#393A34\">(</span><span>path</span><span class=\"token\" style=\"color:#393A34\">,</span><span> fps</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">20</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-eqUAAy jevAiY cell\" style=\"box-shadow:none\"><div class=\"sc-jXbUNg gqRgKk markdown\"><p><img src=\"https://raw.githubusercontent.com/holtzy/The-Python-Graph-Gallery/master/static/animations/web-animated-line-chart-with-text-3.gif\" alt=\"gif\"/></p></div></div><div class=\"sc-eqUAAy jevAiY cell\" style=\"box-shadow:none\"><div class=\"sc-jXbUNg gqRgKk markdown\"><h2>Text animation</h2>\n<p><strong>Displaying text in animations can present two main challenges:</strong></p>\n<ul>\n<li><strong>Determining which part of the text to show at each frame</strong>: To address this, we <strong>calculate the number of characters</strong> to display incrementally with each frame. This method effectively creates the illusion that the text is <strong>unfolding gradually</strong> throughout the animation.</li>\n<li><strong>Applying varying styles to different parts of the text</strong>: We tackle this by defining two functions. The first function removes any unpaired &quot;&lt;&quot; symbols to ensure compatibility with the <a href=\"/advanced-custom-annotations-matplotlib\"><strong>highlight_text package</strong></a>, which utilizes &quot;&lt;&gt;&quot; to enclose strings. This preprocessing step is crucial, especially when the text isn&#x27;t fully displayed in a frame. After preprocessing, we <strong>count the enclosed strings</strong> to correctly set the <code>highlight_textprops</code> argument, ensuring the right style and length are applied at each animation step.</li>\n</ul></div></div><div class=\"sc-eqUAAy jevAiY cell\" style=\"box-shadow:none\"><div class=\"sc-gsFSXq eSaGKB input-container\"><pre class=\"sc-iGgWBj gcBMNR input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code class=\"language-python\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#0000ff\">def</span><span> </span><span class=\"token\" style=\"color:#393A34\">remove_unmatched_lt</span><span class=\"token\" style=\"color:#393A34\">(</span><span>text</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span><span>   </span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">&quot;&quot;&quot;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   Remove unmatched &#x27;&lt;&#x27; characters from text.\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   Examples:\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   text = &#x27;&lt;hello world&#x27;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   remove_unmatched_lt(text)\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   &gt; &#x27;hello world&#x27;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   text = &#x27;hello &lt;world&gt;&#x27;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   remove_unmatched_lt(text)\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   &gt; &#x27;hello &lt;world&gt;&#x27;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   &quot;&quot;&quot;</span><span>\n</span><span>   pattern </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">r&#x27;&lt;(?![^&lt;&gt;]*&gt;)&#x27;</span><span>\n</span><span>   cleaned_text </span><span class=\"token\" style=\"color:#393A34\">=</span><span> re</span><span class=\"token\" style=\"color:#393A34\">.</span><span>sub</span><span class=\"token\" style=\"color:#393A34\">(</span><span>pattern</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> text</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>   </span><span class=\"token\" style=\"color:#0000ff\">return</span><span> cleaned_text\n</span>\n<span></span><span class=\"token\" style=\"color:#0000ff\">def</span><span> </span><span class=\"token\" style=\"color:#393A34\">count_closed_and_enclosed</span><span class=\"token\" style=\"color:#393A34\">(</span><span>text</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span><span>   </span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">&quot;&quot;&quot;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   Count the number of closed and enclosed tags in text.\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   Examples:\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   text = &#x27;&lt;hello world&gt;&#x27;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   count_closed_and_enclosed(text)\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   &gt; 1\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   text = &#x27;&lt;hello&gt; &lt;world&gt;&#x27;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   count_closed_and_enclosed(text)\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   &gt; 2\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   &quot;&quot;&quot;</span><span>\n</span><span>   closed_pattern </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">r&#x27;&lt;[^&lt;&gt;]*&gt;&#x27;</span><span>\n</span><span>   closed_tags </span><span class=\"token\" style=\"color:#393A34\">=</span><span> re</span><span class=\"token\" style=\"color:#393A34\">.</span><span>findall</span><span class=\"token\" style=\"color:#393A34\">(</span><span>closed_pattern</span><span class=\"token\" style=\"color:#393A34\">,</span><span> text</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>   </span><span class=\"token\" style=\"color:#0000ff\">return</span><span> </span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span><span>closed_tags</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-eqUAAy jevAiY cell\" style=\"box-shadow:none\"><div class=\"sc-jXbUNg gqRgKk markdown\"><p>Also, to prevent the text from becoming <strong>too lengthy</strong> and to ensure <strong>line breaks</strong>, we use the <code>textwrap</code> module, which allows us to set a maximum number of characters per line.</p></div></div><div class=\"sc-eqUAAy jevAiY cell\" style=\"box-shadow:none\"><div class=\"sc-gsFSXq eSaGKB input-container\"><pre class=\"sc-iGgWBj gcBMNR input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code class=\"language-python\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># parameters</span><span>\n</span><span>background_color </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;#0d1b2a&#x27;</span><span>\n</span><span>text_color </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;#fefae0&#x27;</span><span>\n</span><span>line_color </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;#d90429&#x27;</span><span>\n</span><span>dpi </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">50</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># description</span><span>\n</span><span>description </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token string-interpolation token\" style=\"color:#A31515\">f&quot;&quot;&quot;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">During the 1970s, the reputation of plastic was impacted by concerns about unrecycled waste, as plastic &lt;remains in nature forever&gt;. It wasn&#x27;t until the 1980s that the plastics industry began to &lt;encourage recycling&gt;.\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">Around 2007 and 2008, the plastics industry felt the impact of the rise in crude oil prices to the &lt;highest level ever recorded&gt;, due to the credit crunch. \n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">If the trend continues, we can expect to exceed the symbolic threshold of &lt;1 billion tons&gt; of plastic produced annually by 2050.\n</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">&quot;&quot;&quot;</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># Setting up the plot</span><span>\n</span><span>fig</span><span class=\"token\" style=\"color:#393A34\">,</span><span> ax </span><span class=\"token\" style=\"color:#393A34\">=</span><span> plt</span><span class=\"token\" style=\"color:#393A34\">.</span><span>subplots</span><span class=\"token\" style=\"color:#393A34\">(</span><span>figsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">10</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">6</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span> dpi</span><span class=\"token\" style=\"color:#393A34\">=</span><span>dpi</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>fig</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_facecolor</span><span class=\"token\" style=\"color:#393A34\">(</span><span>background_color</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_facecolor</span><span class=\"token\" style=\"color:#393A34\">(</span><span>background_color</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>tick_params</span><span class=\"token\" style=\"color:#393A34\">(</span><span>axis</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;y&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> colors</span><span class=\"token\" style=\"color:#393A34\">=</span><span>text_color</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>spines</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;left&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_color</span><span class=\"token\" style=\"color:#393A34\">(</span><span>text_color</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># font</span><span>\n</span><span>personal_path </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;/Users/josephbarbier/Library/Fonts/&#x27;</span><span>\n</span><span>font_path </span><span class=\"token\" style=\"color:#393A34\">=</span><span> personal_path </span><span class=\"token\" style=\"color:#393A34\">+</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;FiraSans-Light.ttf&#x27;</span><span>\n</span><span>font </span><span class=\"token\" style=\"color:#393A34\">=</span><span> FontProperties</span><span class=\"token\" style=\"color:#393A34\">(</span><span>fname</span><span class=\"token\" style=\"color:#393A34\">=</span><span>font_path</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>bold_font </span><span class=\"token\" style=\"color:#393A34\">=</span><span> FontProperties</span><span class=\"token\" style=\"color:#393A34\">(</span><span>fname</span><span class=\"token\" style=\"color:#393A34\">=</span><span>personal_path </span><span class=\"token\" style=\"color:#393A34\">+</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;FiraSans-Medium.ttf&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># Update function for the animation</span><span>\n</span><span></span><span class=\"token\" style=\"color:#0000ff\">def</span><span> </span><span class=\"token\" style=\"color:#393A34\">update</span><span class=\"token\" style=\"color:#393A34\">(</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span>\n<span>    </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># skip first frame</span><span>\n</span><span>    </span><span class=\"token\" style=\"color:#0000ff\">if</span><span> frame </span><span class=\"token\" style=\"color:#393A34\">==</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span><span>        </span><span class=\"token\" style=\"color:#0000ff\">return</span><span> </span><span class=\"token\" style=\"color:#36acaa\">None</span><span>\n</span>\n<span>    </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># initialize subset of data</span><span>\n</span><span>    subset_df </span><span class=\"token\" style=\"color:#393A34\">=</span><span> df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>iloc</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">:</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>    ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>clear</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>    ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>yaxis</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_major_formatter</span><span class=\"token\" style=\"color:#393A34\">(</span><span>FormatStrFormatter</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;%.0f&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>    </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># create the line chart</span><span>\n</span><span>    ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>plot</span><span class=\"token\" style=\"color:#393A34\">(</span><span>subset_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>index</span><span class=\"token\" style=\"color:#393A34\">,</span><span> subset_df</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;plastic-production&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span> color</span><span class=\"token\" style=\"color:#393A34\">=</span><span>line_color</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>    ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>scatter</span><span class=\"token\" style=\"color:#393A34\">(</span><span>subset_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>index</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">-</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span> subset_df</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;plastic-production&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span>values</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">-</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span> color</span><span class=\"token\" style=\"color:#393A34\">=</span><span>line_color</span><span class=\"token\" style=\"color:#393A34\">,</span><span> s</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">100</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>    </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># date in the background</span><span>\n</span><span>    year </span><span class=\"token\" style=\"color:#393A34\">=</span><span> df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>index</span><span class=\"token\" style=\"color:#393A34\">[</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>    fig_text</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>        </span><span class=\"token\" style=\"color:#36acaa\">0.14</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0.3</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        </span><span class=\"token\" style=\"color:#A31515\">&#x27;1950 - &#x27;</span><span> </span><span class=\"token\" style=\"color:#393A34\">+</span><span> </span><span class=\"token builtin\">str</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token builtin\">round</span><span class=\"token\" style=\"color:#393A34\">(</span><span>year</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        ha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;left&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> va</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;top&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        fontsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">30</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        font</span><span class=\"token\" style=\"color:#393A34\">=</span><span>bold_font</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        color</span><span class=\"token\" style=\"color:#393A34\">=</span><span>text_color</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        fontweight</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        alpha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">0.3</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        fig</span><span class=\"token\" style=\"color:#393A34\">=</span><span>fig\n</span><span>    </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>    </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># custom axes</span><span>\n</span><span>    y_min </span><span class=\"token\" style=\"color:#393A34\">=</span><span> df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>iloc</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">:</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">+</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span>axis</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">min</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>    y_max </span><span class=\"token\" style=\"color:#393A34\">=</span><span> df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>iloc</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">:</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">+</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span>axis</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">max</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>    ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_ylim</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">,</span><span> y_max</span><span class=\"token\" style=\"color:#393A34\">*</span><span class=\"token\" style=\"color:#36acaa\">1.1</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>    ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>spines</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;top&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;right&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;bottom&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_visible</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">False</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>    ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_xticks</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>    </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># title</span><span>\n</span><span>    text </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">&quot;&quot;&quot;&lt;Global plastics production has grown dramatically and is set to continue to do so&gt;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">    &lt;Evolution and prediction of annual plastic production&gt;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">    &lt;Data after 2020 are predicted values based on a polynomial regression&gt;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">    &quot;&quot;&quot;</span><span>\n</span><span>    fig_text</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>        </span><span class=\"token\" style=\"color:#36acaa\">0.13</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0.92</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        text</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        ha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;left&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> va</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;top&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        font</span><span class=\"token\" style=\"color:#393A34\">=</span><span>font</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        highlight_textprops</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">[</span><span>\n</span><span>            </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;color&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span>text_color</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;fontsize&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#36acaa\">14</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;font&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span>bold_font</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>            </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;color&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span>text_color</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;fontsize&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#36acaa\">10</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>            </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;color&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span>text_color</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;fontsize&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#36acaa\">10</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        </span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        fig</span><span class=\"token\" style=\"color:#393A34\">=</span><span>fig\n</span><span>    </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>    </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># credit annotation</span><span>\n</span><span>    text </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">&quot;&quot;&quot;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">    Developed by &lt;@joseph_barbier&gt;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">    &quot;&quot;&quot;</span><span>\n</span><span>    fig_text</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>        </span><span class=\"token\" style=\"color:#36acaa\">0.9</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        text</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        ha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;right&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> va</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;bottom&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        fontsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">7</span><span class=\"token\" style=\"color:#393A34\">,</span><span> font</span><span class=\"token\" style=\"color:#393A34\">=</span><span>font</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        color</span><span class=\"token\" style=\"color:#393A34\">=</span><span>text_color</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        highlight_textprops</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">[</span><span>\n</span><span>            </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;font&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span>bold_font</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        </span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        fig</span><span class=\"token\" style=\"color:#393A34\">=</span><span>fig\n</span><span>    </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>    </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># get text to display at current frame</span><span>\n</span><span>    total_chars </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span><span>description</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>    effective_frame_count </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span><span>df</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#393A34\">-</span><span> </span><span class=\"token\" style=\"color:#36acaa\">80</span><span> </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># text ends 80 frames before the video&#x27;s end</span><span>\n</span><span>    num_chars </span><span class=\"token\" style=\"color:#393A34\">=</span><span> math</span><span class=\"token\" style=\"color:#393A34\">.</span><span>ceil</span><span class=\"token\" style=\"color:#393A34\">(</span><span>total_chars </span><span class=\"token\" style=\"color:#393A34\">*</span><span> </span><span class=\"token\" style=\"color:#393A34\">(</span><span>frame </span><span class=\"token\" style=\"color:#393A34\">/</span><span> effective_frame_count</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#0000ff\">if</span><span> frame </span><span class=\"token\" style=\"color:#393A34\">&lt;</span><span> effective_frame_count </span><span class=\"token\" style=\"color:#0000ff\">else</span><span> total_chars\n</span><span>    current_description </span><span class=\"token\" style=\"color:#393A34\">=</span><span> description</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">:</span><span>num_chars</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>    current_description </span><span class=\"token\" style=\"color:#393A34\">=</span><span> remove_unmatched_lt</span><span class=\"token\" style=\"color:#393A34\">(</span><span>current_description</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># remove unmatched &#x27;&lt;&#x27; characters</span><span>\n</span><span>    num_closed_tags </span><span class=\"token\" style=\"color:#393A34\">=</span><span> count_closed_and_enclosed</span><span class=\"token\" style=\"color:#393A34\">(</span><span>current_description</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># count number of closed tags</span><span>\n</span><span>    </span><span class=\"token\" style=\"color:#0000ff\">if</span><span> num_closed_tags </span><span class=\"token\" style=\"color:#393A34\">&gt;</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span><span>        highlight_textprops </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;font&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span>bold_font</span><span class=\"token\" style=\"color:#393A34\">}</span><span> </span><span class=\"token\" style=\"color:#0000ff\">for</span><span> _ </span><span class=\"token\" style=\"color:#0000ff\">in</span><span> </span><span class=\"token builtin\">range</span><span class=\"token\" style=\"color:#393A34\">(</span><span>num_closed_tags</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>    </span><span class=\"token\" style=\"color:#0000ff\">else</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span><span>        highlight_textprops </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">None</span><span>\n</span><span>    wrapped_text </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;\\n&#x27;</span><span class=\"token\" style=\"color:#393A34\">.</span><span>join</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">[</span><span>textwrap</span><span class=\"token\" style=\"color:#393A34\">.</span><span>fill</span><span class=\"token\" style=\"color:#393A34\">(</span><span>paragraph</span><span class=\"token\" style=\"color:#393A34\">,</span><span> width</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">75</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#0000ff\">for</span><span> paragraph </span><span class=\"token\" style=\"color:#0000ff\">in</span><span> current_description</span><span class=\"token\" style=\"color:#393A34\">.</span><span>split</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;\\n&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>    fig_text</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>        </span><span class=\"token\" style=\"color:#36acaa\">0.147</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0.75</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        wrapped_text</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        ha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;left&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> va</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;top&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        fontsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">10</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        font</span><span class=\"token\" style=\"color:#393A34\">=</span><span>font</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        color</span><span class=\"token\" style=\"color:#393A34\">=</span><span>text_color</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        highlight_textprops</span><span class=\"token\" style=\"color:#393A34\">=</span><span>highlight_textprops</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        fig</span><span class=\"token\" style=\"color:#393A34\">=</span><span>fig\n</span><span>    </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># create and save animation</span><span>\n</span><span>path </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;../../static/animations/web-animated-line-chart-with-text-4.gif&#x27;</span><span>\n</span><span>ani </span><span class=\"token\" style=\"color:#393A34\">=</span><span> FuncAnimation</span><span class=\"token\" style=\"color:#393A34\">(</span><span>fig</span><span class=\"token\" style=\"color:#393A34\">,</span><span> update</span><span class=\"token\" style=\"color:#393A34\">,</span><span> frames</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span><span>df</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>ani</span><span class=\"token\" style=\"color:#393A34\">.</span><span>save</span><span class=\"token\" style=\"color:#393A34\">(</span><span>path</span><span class=\"token\" style=\"color:#393A34\">,</span><span> fps</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">5</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-eqUAAy jevAiY cell\" style=\"box-shadow:none\"><div class=\"sc-jXbUNg gqRgKk markdown\"><p><img src=\"https://raw.githubusercontent.com/holtzy/The-Python-Graph-Gallery/master/static/animations/web-animated-line-chart-with-text-4.gif\" alt=\"gif\"/></p></div></div><div class=\"sc-eqUAAy jevAiY cell\" style=\"box-shadow:none\"><div class=\"sc-jXbUNg gqRgKk markdown\"><h2>Final animation</h2>\n<p>The last step is for customizing the length and the resolution of our animation.</p>\n<p>First, we change the value of the <code>dpi</code> argument to a larger one (200 is enough in most cases).</p>\n<p>Then, we:</p>\n<ol>\n<li><strong>Open the Image</strong></li>\n<li><strong>Extract Frames</strong>: extract all the frames from the GIF and makes copies of them.</li>\n<li><strong>Set Frame Duration</strong>: For each frame, we set how long the frame should be displayed. All frames get the same initial duration, except the last frame, which is set to stay longer (10 seconds).</li>\n<li><strong>Save the New GIF</strong>: Finally, we save these modified frames back into a new GIF file, keeping all frames and setting it to loop forever.</li>\n</ol>\n<p>The code now requires a few minutes to execute but results in a significantly improved and more visually appealing animation!</p></div></div><div class=\"sc-eqUAAy jevAiY cell\" style=\"box-shadow:none\"><div class=\"sc-gsFSXq eSaGKB input-container\"><pre class=\"sc-iGgWBj gcBMNR input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code class=\"language-python\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#0000ff\">def</span><span> </span><span class=\"token\" style=\"color:#393A34\">remove_unmatched_lt</span><span class=\"token\" style=\"color:#393A34\">(</span><span>text</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span><span>   </span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">&quot;&quot;&quot;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   Remove unmatched &#x27;&lt;&#x27; characters from text.\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   Examples:\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   text = &#x27;&lt;hello world&#x27;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   remove_unmatched_lt(text)\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   &gt; &#x27;hello world&#x27;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   text = &#x27;hello &lt;world&gt;&#x27;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   remove_unmatched_lt(text)\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   &gt; &#x27;hello &lt;world&gt;&#x27;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   &quot;&quot;&quot;</span><span>\n</span><span>   pattern </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">r&#x27;&lt;(?![^&lt;&gt;]*&gt;)&#x27;</span><span>\n</span><span>   cleaned_text </span><span class=\"token\" style=\"color:#393A34\">=</span><span> re</span><span class=\"token\" style=\"color:#393A34\">.</span><span>sub</span><span class=\"token\" style=\"color:#393A34\">(</span><span>pattern</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> text</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>   </span><span class=\"token\" style=\"color:#0000ff\">return</span><span> cleaned_text\n</span>\n<span></span><span class=\"token\" style=\"color:#0000ff\">def</span><span> </span><span class=\"token\" style=\"color:#393A34\">count_closed_and_enclosed</span><span class=\"token\" style=\"color:#393A34\">(</span><span>text</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span><span>   </span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">&quot;&quot;&quot;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   Count the number of closed and enclosed tags in text.\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   Examples:\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   text = &#x27;&lt;hello world&gt;&#x27;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   count_closed_and_enclosed(text)\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   &gt; 1\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   text = &#x27;&lt;hello&gt; &lt;world&gt;&#x27;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   count_closed_and_enclosed(text)\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   &gt; 2\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   &quot;&quot;&quot;</span><span>\n</span><span>   closed_pattern </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">r&#x27;&lt;[^&lt;&gt;]*&gt;&#x27;</span><span>\n</span><span>   closed_tags </span><span class=\"token\" style=\"color:#393A34\">=</span><span> re</span><span class=\"token\" style=\"color:#393A34\">.</span><span>findall</span><span class=\"token\" style=\"color:#393A34\">(</span><span>closed_pattern</span><span class=\"token\" style=\"color:#393A34\">,</span><span> text</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>   </span><span class=\"token\" style=\"color:#0000ff\">return</span><span> </span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span><span>closed_tags</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-eqUAAy jevAiY cell\" style=\"box-shadow:none\"><div class=\"sc-gsFSXq eSaGKB input-container\"><pre class=\"sc-iGgWBj gcBMNR input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code class=\"language-python\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># parameters</span><span>\n</span><span>background_color </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;#0d1b2a&#x27;</span><span>\n</span><span>text_color </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;#fefae0&#x27;</span><span>\n</span><span>line_color </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;#d90429&#x27;</span><span>\n</span><span>dpi </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">200</span><span>\n</span><span>initial_duration </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">30</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># font</span><span>\n</span><span>personal_path </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;/Users/josephbarbier/Library/Fonts/&#x27;</span><span>\n</span><span>font_path </span><span class=\"token\" style=\"color:#393A34\">=</span><span> personal_path </span><span class=\"token\" style=\"color:#393A34\">+</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;FiraSans-Light.ttf&#x27;</span><span>\n</span><span>font </span><span class=\"token\" style=\"color:#393A34\">=</span><span> FontProperties</span><span class=\"token\" style=\"color:#393A34\">(</span><span>fname</span><span class=\"token\" style=\"color:#393A34\">=</span><span>font_path</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>bold_font </span><span class=\"token\" style=\"color:#393A34\">=</span><span> FontProperties</span><span class=\"token\" style=\"color:#393A34\">(</span><span>fname</span><span class=\"token\" style=\"color:#393A34\">=</span><span>personal_path </span><span class=\"token\" style=\"color:#393A34\">+</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;FiraSans-Medium.ttf&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># description</span><span>\n</span><span>description </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token string-interpolation token\" style=\"color:#A31515\">f&quot;&quot;&quot;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">During the 1970s, the reputation of plastic was impacted by concerns about unrecycled waste, as plastic &lt;remains in nature forever&gt;. It wasn&#x27;t until the 1980s that the plastics industry began to &lt;encourage recycling&gt;.\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">Around 2007 and 2008, the plastics industry felt the impact of the rise in crude oil prices to the &lt;highest level ever recorded&gt;, due to the credit crunch. \n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">If the trend continues, we can expect to exceed the symbolic threshold of &lt;1 billion tons&gt; of plastic produced annually by 2050.\n</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">&quot;&quot;&quot;</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># Setting up the plot</span><span>\n</span><span>fig</span><span class=\"token\" style=\"color:#393A34\">,</span><span> ax </span><span class=\"token\" style=\"color:#393A34\">=</span><span> plt</span><span class=\"token\" style=\"color:#393A34\">.</span><span>subplots</span><span class=\"token\" style=\"color:#393A34\">(</span><span>figsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">10</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">6</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span> dpi</span><span class=\"token\" style=\"color:#393A34\">=</span><span>dpi</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>fig</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_facecolor</span><span class=\"token\" style=\"color:#393A34\">(</span><span>background_color</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_facecolor</span><span class=\"token\" style=\"color:#393A34\">(</span><span>background_color</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>tick_params</span><span class=\"token\" style=\"color:#393A34\">(</span><span>axis</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;y&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> colors</span><span class=\"token\" style=\"color:#393A34\">=</span><span>text_color</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>spines</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;left&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_color</span><span class=\"token\" style=\"color:#393A34\">(</span><span>text_color</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># Update function for the animation</span><span>\n</span><span></span><span class=\"token\" style=\"color:#0000ff\">def</span><span> </span><span class=\"token\" style=\"color:#393A34\">update</span><span class=\"token\" style=\"color:#393A34\">(</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span>\n<span>    </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># skip first frame</span><span>\n</span><span>    </span><span class=\"token\" style=\"color:#0000ff\">if</span><span> frame </span><span class=\"token\" style=\"color:#393A34\">==</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span><span>        </span><span class=\"token\" style=\"color:#0000ff\">return</span><span> </span><span class=\"token\" style=\"color:#36acaa\">None</span><span>\n</span>\n<span>    </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># initialize subset of data</span><span>\n</span><span>    subset_df </span><span class=\"token\" style=\"color:#393A34\">=</span><span> df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>iloc</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">:</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>    ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>clear</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>    ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>yaxis</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_major_formatter</span><span class=\"token\" style=\"color:#393A34\">(</span><span>FormatStrFormatter</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;%.0f&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>    </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># create the line chart</span><span>\n</span><span>    ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>plot</span><span class=\"token\" style=\"color:#393A34\">(</span><span>subset_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>index</span><span class=\"token\" style=\"color:#393A34\">,</span><span> subset_df</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;plastic-production&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span> color</span><span class=\"token\" style=\"color:#393A34\">=</span><span>line_color</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>    ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>scatter</span><span class=\"token\" style=\"color:#393A34\">(</span><span>subset_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>index</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">-</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span> subset_df</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;plastic-production&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span>values</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">-</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span> color</span><span class=\"token\" style=\"color:#393A34\">=</span><span>line_color</span><span class=\"token\" style=\"color:#393A34\">,</span><span> s</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">100</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>    </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># date in the background</span><span>\n</span><span>    year </span><span class=\"token\" style=\"color:#393A34\">=</span><span> df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>index</span><span class=\"token\" style=\"color:#393A34\">[</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>    fig_text</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>        </span><span class=\"token\" style=\"color:#36acaa\">0.14</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0.3</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        </span><span class=\"token\" style=\"color:#A31515\">&#x27;1950 - &#x27;</span><span> </span><span class=\"token\" style=\"color:#393A34\">+</span><span> </span><span class=\"token builtin\">str</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token builtin\">round</span><span class=\"token\" style=\"color:#393A34\">(</span><span>year</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        ha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;left&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> va</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;top&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        fontsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">30</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        font</span><span class=\"token\" style=\"color:#393A34\">=</span><span>bold_font</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        color</span><span class=\"token\" style=\"color:#393A34\">=</span><span>text_color</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        fontweight</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        alpha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">0.3</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        fig</span><span class=\"token\" style=\"color:#393A34\">=</span><span>fig\n</span><span>    </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>    </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># custom axes</span><span>\n</span><span>    y_min </span><span class=\"token\" style=\"color:#393A34\">=</span><span> df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>iloc</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">:</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">+</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span>axis</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">min</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>    y_max </span><span class=\"token\" style=\"color:#393A34\">=</span><span> df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>iloc</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">:</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">+</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span>axis</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">max</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>    ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_ylim</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">,</span><span> y_max</span><span class=\"token\" style=\"color:#393A34\">*</span><span class=\"token\" style=\"color:#36acaa\">1.1</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>    ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>spines</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;top&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;right&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;bottom&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_visible</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">False</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>    ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_xticks</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>    </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># get text to display at current frame</span><span>\n</span><span>    total_chars </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span><span>description</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>    effective_frame_count </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span><span>df</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#393A34\">-</span><span> </span><span class=\"token\" style=\"color:#36acaa\">80</span><span> </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># ends 100 frames before the end</span><span>\n</span><span>    num_chars </span><span class=\"token\" style=\"color:#393A34\">=</span><span> math</span><span class=\"token\" style=\"color:#393A34\">.</span><span>ceil</span><span class=\"token\" style=\"color:#393A34\">(</span><span>total_chars </span><span class=\"token\" style=\"color:#393A34\">*</span><span> </span><span class=\"token\" style=\"color:#393A34\">(</span><span>frame </span><span class=\"token\" style=\"color:#393A34\">/</span><span> effective_frame_count</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#0000ff\">if</span><span> frame </span><span class=\"token\" style=\"color:#393A34\">&lt;</span><span> effective_frame_count </span><span class=\"token\" style=\"color:#0000ff\">else</span><span> total_chars\n</span><span>    current_description </span><span class=\"token\" style=\"color:#393A34\">=</span><span> description</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">:</span><span>num_chars</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>    current_description </span><span class=\"token\" style=\"color:#393A34\">=</span><span> remove_unmatched_lt</span><span class=\"token\" style=\"color:#393A34\">(</span><span>current_description</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>    num_closed_tags </span><span class=\"token\" style=\"color:#393A34\">=</span><span> count_closed_and_enclosed</span><span class=\"token\" style=\"color:#393A34\">(</span><span>current_description</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>    </span><span class=\"token\" style=\"color:#0000ff\">if</span><span> num_closed_tags </span><span class=\"token\" style=\"color:#393A34\">&gt;</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span><span>        highlight_textprops </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;font&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span>bold_font</span><span class=\"token\" style=\"color:#393A34\">}</span><span> </span><span class=\"token\" style=\"color:#0000ff\">for</span><span> _ </span><span class=\"token\" style=\"color:#0000ff\">in</span><span> </span><span class=\"token builtin\">range</span><span class=\"token\" style=\"color:#393A34\">(</span><span>num_closed_tags</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>    </span><span class=\"token\" style=\"color:#0000ff\">else</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span><span>        highlight_textprops </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">None</span><span>\n</span><span>    wrapped_text </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;\\n&#x27;</span><span class=\"token\" style=\"color:#393A34\">.</span><span>join</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">[</span><span>textwrap</span><span class=\"token\" style=\"color:#393A34\">.</span><span>fill</span><span class=\"token\" style=\"color:#393A34\">(</span><span>paragraph</span><span class=\"token\" style=\"color:#393A34\">,</span><span> width</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">75</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#0000ff\">for</span><span> paragraph </span><span class=\"token\" style=\"color:#0000ff\">in</span><span> current_description</span><span class=\"token\" style=\"color:#393A34\">.</span><span>split</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;\\n&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>    fig_text</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>        </span><span class=\"token\" style=\"color:#36acaa\">0.147</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0.75</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        wrapped_text</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        ha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;left&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> va</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;top&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        fontsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">10</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        font</span><span class=\"token\" style=\"color:#393A34\">=</span><span>font</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        color</span><span class=\"token\" style=\"color:#393A34\">=</span><span>text_color</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        highlight_textprops</span><span class=\"token\" style=\"color:#393A34\">=</span><span>highlight_textprops</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        fig</span><span class=\"token\" style=\"color:#393A34\">=</span><span>fig\n</span><span>    </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>    </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># title</span><span>\n</span><span>    text </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">&quot;&quot;&quot;&lt;Global plastics production has grown dramatically and is set to continue to do so&gt;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">    &lt;Evolution and prediction of annual plastic production&gt;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">    &lt;Data after 2020 are predicted values based on a polynomial regression&gt;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">    &quot;&quot;&quot;</span><span>\n</span><span>    fig_text</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>        </span><span class=\"token\" style=\"color:#36acaa\">0.13</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0.92</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        text</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        ha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;left&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> va</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;top&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        font</span><span class=\"token\" style=\"color:#393A34\">=</span><span>font</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        highlight_textprops</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">[</span><span>\n</span><span>            </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;color&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span>text_color</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;fontsize&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#36acaa\">14</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;font&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span>bold_font</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>            </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;color&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span>text_color</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;fontsize&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#36acaa\">10</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>            </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;color&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span>text_color</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;fontsize&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#36acaa\">10</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        </span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        fig</span><span class=\"token\" style=\"color:#393A34\">=</span><span>fig\n</span><span>    </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>    </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># credit annotation</span><span>\n</span><span>    text </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">&quot;&quot;&quot;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">    Developed by &lt;@joseph_barbier&gt;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">    &quot;&quot;&quot;</span><span>\n</span><span>    fig_text</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>        </span><span class=\"token\" style=\"color:#36acaa\">0.9</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        text</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        ha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;right&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> va</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;bottom&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        fontsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">7</span><span class=\"token\" style=\"color:#393A34\">,</span><span> font</span><span class=\"token\" style=\"color:#393A34\">=</span><span>font</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        color</span><span class=\"token\" style=\"color:#393A34\">=</span><span>text_color</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        highlight_textprops</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">[</span><span>\n</span><span>            </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;font&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span>bold_font</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        </span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        fig</span><span class=\"token\" style=\"color:#393A34\">=</span><span>fig\n</span><span>    </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># create and save animation</span><span>\n</span><span>path </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;../../static/animations/web-animated-line-chart-with-text-5.gif&#x27;</span><span>\n</span><span>ani </span><span class=\"token\" style=\"color:#393A34\">=</span><span> FuncAnimation</span><span class=\"token\" style=\"color:#393A34\">(</span><span>fig</span><span class=\"token\" style=\"color:#393A34\">,</span><span> update</span><span class=\"token\" style=\"color:#393A34\">,</span><span> frames</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span><span>df</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>ani</span><span class=\"token\" style=\"color:#393A34\">.</span><span>save</span><span class=\"token\" style=\"color:#393A34\">(</span><span>path</span><span class=\"token\" style=\"color:#393A34\">,</span><span> fps</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">20</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span></span><span class=\"token\" style=\"color:#0000ff\">print</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;Original animation finished&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<!-- -->\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># get initial frames</span><span>\n</span><span></span><span class=\"token\" style=\"color:#0000ff\">with</span><span> Image</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">open</span><span class=\"token\" style=\"color:#393A34\">(</span><span>path</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#0000ff\">as</span><span> img</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span><span>    frames </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#393A34\">[</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">.</span><span>copy</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#0000ff\">for</span><span> frame </span><span class=\"token\" style=\"color:#0000ff\">in</span><span> ImageSequence</span><span class=\"token\" style=\"color:#393A34\">.</span><span>Iterator</span><span class=\"token\" style=\"color:#393A34\">(</span><span>img</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># set duration of each frame</span><span>\n</span><span></span><span class=\"token\" style=\"color:#0000ff\">for</span><span> i</span><span class=\"token\" style=\"color:#393A34\">,</span><span> frame </span><span class=\"token\" style=\"color:#0000ff\">in</span><span> </span><span class=\"token builtin\">enumerate</span><span class=\"token\" style=\"color:#393A34\">(</span><span>frames</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span><span>    frame_duration </span><span class=\"token\" style=\"color:#393A34\">=</span><span> initial_duration\n</span>\n<span>    </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># stay for last date</span><span>\n</span><span>    </span><span class=\"token\" style=\"color:#0000ff\">if</span><span> i </span><span class=\"token\" style=\"color:#393A34\">==</span><span> </span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span><span>frames</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#393A34\">-</span><span> </span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span><span>        frame_duration </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">10000</span><span>\n</span><span>    frame</span><span class=\"token\" style=\"color:#393A34\">.</span><span>info</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;duration&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span> </span><span class=\"token\" style=\"color:#393A34\">=</span><span> frame_duration\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># Save the modified frames as a new GIF</span><span>\n</span><span>frames</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span>save</span><span class=\"token\" style=\"color:#393A34\">(</span><span>path</span><span class=\"token\" style=\"color:#393A34\">,</span><span> save_all</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">True</span><span class=\"token\" style=\"color:#393A34\">,</span><span> append_images</span><span class=\"token\" style=\"color:#393A34\">=</span><span>frames</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span> loop</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span></span><span class=\"token\" style=\"color:#0000ff\">print</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;Final animation finished!&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-eqUAAy jevAiY cell\" style=\"box-shadow:none\"><div class=\"sc-jXbUNg gqRgKk markdown\"><p><img src=\"https://raw.githubusercontent.com/holtzy/The-Python-Graph-Gallery/master/static/animations/web-animated-line-chart-with-text-5.gif\" alt=\"gif\"/></p></div></div><div class=\"sc-eqUAAy jevAiY cell\" style=\"box-shadow:none\"><div class=\"sc-jXbUNg gqRgKk markdown\"><h2>Going further</h2>\n<p>This article explains how to reproduce <strong>an animation</strong> that displays the number of outer space objects launched by the US and Russia over the years. The animation is enriched with <strong>annotations</strong> that highlight important events and a text that appears throughout the animation.</p>\n<p>You might be interested in</p>\n<ul>\n<li>the <a href=\"/stacked-area-plot\">stacked area section</a></li>\n<li>the <a href=\"/animation\">animation section</a></li>\n</ul></div></div></div></div>","metadata":{"title":"Line chart animation with text appearing throughout","description":"<p><strong>Animation</strong> serves as a dynamic medium for storytelling, and <a href='/matplotlib'><strong>Matplotlib</strong></a> offers specialized tools for this purpose.</p><p>In this tutorial, we'll craft an <a href='/animation'><strong>animation</strong></a> featuring a <a href='/line-chart'><strong>line chart</strong></a>. It includes <strong>persistent text</strong> that underscores pivotal moments. Expect the final visualization to be adorned with precise annotations and stylish color choices.</p><p>This guide is structured to be a comprehensive walkthrough, complete with <strong>executable code</strong> that you can replicate.</p>","seoDescription":"How to create an animation of a line chart, or race chart, with text appearing throughout using Matplotlib. Learn how to customize the axes, add dates, a title, and a source to the animation.","family":"general","chartType":"animation","keywords":"animation, gif, area, matplotlib, line, race, color, plot, chart, background, text","slug":"web-animated-line-chart-with-text"}}},"pageContext":{"id":"09ea3567-9b2d-5fdd-9610-4f86a250c56d >>> JupyterNotebook","slug":"web-animated-line-chart-with-text","__params":{"slug":"web-animated-line-chart-with-text"}}},"staticQueryHashes":["2944911273"],"slicesMap":{}}